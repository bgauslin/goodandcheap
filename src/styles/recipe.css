/* -------------------------------------------------------------------------- */
/* Recipe view.
/* -------------------------------------------------------------------------- */

gc-recipe {
  .cost {
    backdrop-filter: var(--backdrop-filter);
    background-color: var(--callout-background);
    grid-area: 1 / 1;
    line-height: 1.5;
    margin-block: 10% 0;
    padding-block: .5rem;
    padding-inline: .75rem;
    place-self: start;
    z-index: 4;
  }

  .content {
    position: relative;
  }

  /* ---------------------------------------- */
  /* Badge, title, serving. */

  .badge {
    margin-block: 0;
  }

  .badge + h1 {
    margin-block-start: .5em;
  }

  h1 {
    padding-inline-end: 1em;
  }

  .serving {
    margin-block: 0 1em;
  }

  p {
    margin-block: 0 1em;
  }

  /* ---------------------------------------- */
  /* Recipe headings. */

  /**
   * All h2 headings: ingredients, steps, more.
   */
  h2 {
    margin-block: 0;
    padding-block: 1em;
  }

  /**
   * Ingredients and steps headings.
   */
  :is(.ingredients, .steps) {
    :is(h2, h3) {
      padding-inline: var(--gap);
    }
  
    h2 {
      backdrop-filter: var(--backdrop-filter);
      background-color: var(--callout-background);
      border-block-end: 1px solid var(--border-color);
      inset-block: 0 auto;
      position: sticky;
      z-index: 1;
    }
  }

  /**
   * Ingredients headings.
   */
  .ingredients {
    h2 + * {
      padding-block-start: 1em;
    }

    h3 {
      margin-block-start: 0;
    }

    :is(ol, ul) + h3 {
      margin-block-start: 1em;
    }
  }

  /* ---------------------------------------- */
  /* Lists of ingredients and cooking steps. */

  :is(ul, ol) {
    margin-block: 0;
    padding-inline: var(--gap);

    .more & {
      padding-inline: 0;
    }
  }

  :is(.ingredients__list, .steps__list) {
    list-style: none;
  }

  .ingredients__list:last-child {
    padding-block-end: 1em;
  }

  :is(.ingredients__item, .steps__item) {
    display: grid;
    gap: 0 .4em;
    grid: auto / var(--marker-size) 1fr;
  }

  /* ---------------------------------------- */
  /* Ingredients list items. */

  .ingredients__item {
    cursor: pointer;
    padding-block: .3em;

    :is(.checkbox, input[type='checkbox']) {
      grid-area: 1 / 1;
      place-self: center;
    }

    svg {
      fill: none;
      stroke: currentColor;
      stroke-width: 3;
    }

    .checkbox {
      aspect-ratio: 1;
      border: 2px solid var(--icon-color);
      border-radius: var(--marker-size);
      display: grid;
      inline-size: var(--marker-size);
      place-items: center;
    }

    .text {
      grid-area: 1 / 2;
      line-height: 1.2;
      pointer-events: none;
    }

    &.touch .text {
      opacity: var(--opacity);
    }

    &:has(input:focus-visible) {
      .checkbox {
        border-color: var(--icon-add-color);
      }

      .text {
        opacity: var(--opacity);
      }
    }

    @media (any-hover: hover) {
      .checkbox {
        transition: border-color var(--transition);
      }

      .text {
        transition: opacity var(--transition);
      }

      &:hover {
        .checkbox {
          border-color: var(--icon-add-color);
        }

        .text {
          opacity: var(--opacity);
        }
      }
    }

    input[checked] + .checkbox {
      background-color: var(--icon-add-background);
      border-color: var(--icon-add-color);
      color: var(--icon-add-color);
    }
  }

  /* ---------------------------------------- */
  /* Cooking steps. */

  .steps__list {
    counter-reset: steps 0;
    padding-block: 1em var(--gap);
  }

  .steps__item {
    counter-increment: steps;
    margin-block: 0 1em;

    &::before {
      aspect-ratio: 1;
      background-color: var(--text-color);
      border-radius: var(--marker-size);
      color: var(--text-color-inverted);
      content: counter(steps);
      display: grid;
      font-size: var(--subhead-font-size);
      inline-size: var(--marker-size);
      place-content: center;
      place-self: start;
    }
  }

  /* ---------------------------------------- */
  /* Recipes within recipes. */

  .more {
    margin-block: 1rem;
    padding-inline: var(--gap);

    &:last-child {
      margin-block-end: 0;
      padding-block-end: var(--gap);
    }
  
    h2 {
      margin-block: 0;
      padding-block-start: 0;
    }
  
    .steps {
      margin-block: 1em;
    }
  }

  .photo {
    display: grid;
    grid: 1fr / 1fr;
    margin-block: 0 1em;

    & > * {
      grid-area: 1 / 1;
    }
  
    .cost {
      margin-block: 2rem 0;
      place-self: start;
    }
  }
}
